/* ==========================================================================
   homepage-grid.css — quicker + extra depth
   - Snappier transitions (0.18s–0.22s)
   - Stronger hover depth with layered shadow & glow
   - Preserves full-bleed + mobile behaviour
   ========================================================================== */

/* ---------------- VARIABLES ---------------- */
:root {
    --hero-top-offset: 130px;
    --hero-top-offset-mobile: 120px;
    --grid-gap: clamp(0.6rem, 1.2vw, 1.2rem);
    --grid-padding: clamp(0.6rem, 1.6vw, 2rem);
    --grid-entrance-duration: 400ms;
    --grid-entrance-stagger: 0.04s;
    --grid-item-bg: rgba(255,255,255,0.04);
    --grid-item-hover-bg: rgba(255,255,255,0.06);
    --grid-item-min-height: 120px;
    --grid-item-max-height-vh: 40vh;
    --mobile-item-min-height: clamp(160px, 28vh, 360px);

    /* glow color for extra depth (tweak alpha or hue) */
    --grid-hover-glow: rgba(100, 150, 255, 0.10); /* cool bluish glow */
}

/* ---------------- RESET ---------------- */
html, body { height:100%; margin:0; padding:0; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }

.hero { position:relative; width:100%; height:100vh; overflow:hidden; background-repeat:no-repeat; background-position:center; background-size:cover; }

/* ---------------- WRAPPER ---------------- */
.hero-grid-wrap {
    position: absolute;
    left: 0; right: 0;
    top: var(--hero-top-offset);
    width: 100vw;
    height: calc(100vh - var(--hero-top-offset));
    max-height: calc(100vh - var(--hero-top-offset));
    display: flex;
    align-items: stretch;
    justify-content: center;
    padding: 0;
    box-sizing: border-box;
    z-index: 20;
    pointer-events: auto;
    overflow: hidden;
}

/* ---------------- GRID ---------------- */
.home-grid {
    width:100%; max-width:100%; height:100%;
    display:grid;
    gap: var(--grid-gap);
    padding: var(--grid-padding);
    box-sizing:border-box; margin:0;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    align-items:stretch; justify-items:stretch; overflow:hidden;
}

/* ---------------- GRID ITEM (baseline) ---------------- */
.grid-item {
    width:100%; height:100%; min-width:0; box-sizing:border-box;
    background: transparent; border-radius:12px;
    color: rgba(255,255,255,0);
    display:flex; flex-direction:column; justify-content:center; align-items:center;
    text-align:center; padding:0; overflow:hidden; cursor:default;
    min-height: var(--grid-item-min-height);
    max-height: var(--grid-item-max-height-vh);

    /* faster transitions */
    transition:
            opacity 0.18s cubic-bezier(0.4,0,0.2,1),
            background 0.18s cubic-bezier(0.4,0,0.2,1),
            color 0.18s cubic-bezier(0.4,0,0.2,1),
            transform 0.18s cubic-bezier(0.4,0,0.2,1),
            box-shadow 0.22s cubic-bezier(0.4,0,0.2,1),
            backdrop-filter 0.22s cubic-bezier(0.4,0,0.2,1);
    opacity:0;
    position:relative; /* for ::after glow layer */
}

/* glow pseudo-element adds extra depth around hovered tile */
.grid-item::after {
    content: "";
    position: absolute;
    inset: -6px;                 /* extends glow beyond border-radius slightly */
    border-radius: inherit;
    pointer-events: none;
    opacity: 0;
    transform: scale(1);
    transition: opacity 0.22s cubic-bezier(0.4,0,0.2,1), transform 0.22s cubic-bezier(0.4,0,0.2,1);
    box-shadow: 0 24px 64px rgba(0,0,0,0.35); /* baseline deep shadow behind glow */
    background: radial-gradient(60% 40% at 50% 40%, var(--grid-hover-glow), transparent 60%);
    mix-blend-mode: screen;
    z-index: -1;
}

/* thumbnails / images */
.thumb-module img {
    width:100%; height:100%; object-fit:cover; display:block; border-radius:inherit;
    opacity:0; transition: opacity 0.18s cubic-bezier(0.4,0,0.2,1), transform 0.22s ease-out;
}

/* buttons hidden baseline */
.grid-btn {
    background: rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.12);
    padding:0.6rem 1rem; border-radius:8px; color: rgba(255,255,255,0);
    font-weight:600; transition: background 140ms ease, color 140ms ease, transform 140ms ease;
}

/* ---------- Inactive grid item: always transparent and non-interactive ---------- */
.grid-item.inactive {
    opacity: 0 !important;            /* always invisible */
    background: transparent !important;
    color: transparent !important;
    pointer-events: none !important;  /* no clicks, hovers, focus */
    user-select: none;
    touch-action: none;
    animation: none !important;       /* don't participate in entrance animations */
    transition: none !important;      /* no transitions either */
}

/* ---------------- HOVER / FOCUS: reveal only hovered item ---------------- */
/* non-hovered items stay hidden */
.home-grid:hover .grid-item:not(.inactive) {
    /* existing behavior for non-inactive items */
    opacity: 0;
    background: transparent;
    color: rgba(255,255,255,0);
}

/* hovered item: quicker reveal + deeper depth */
.grid-item:not(.inactive):hover,
.grid-item:not(.inactive):focus-within,
.grid-item:not(.inactive):focus {
    opacity: 1 !important;
    background: var(--grid-item-hover-bg);
    color: rgba(255,255,255,0.96);
    transform: scale(1.028); /* subtle lift */
    box-shadow:
            0 6px 18px rgba(0,0,0,0.28),
            0 18px 46px rgba(0,0,0,0.42),
            0 40px 120px rgba(0,0,0,0.32); /* layered deeper shadows for extra depth */
    backdrop-filter: blur(10px);
    transition-duration: 0.18s;
}

/* activate glow pseudo element quickly */
.grid-item:hover::after {
    opacity: 1;
    transform: scale(1.02);
}

/* inner reveals */
.grid-item:not(.inactive):hover img { opacity:1; transform: scale(1.03); }
.grid-item:not(.inactive):hover .grid-btn { color:#fff; background: rgba(255,255,255,0.14); transform: translateY(-3px); }

/* keyboard focus */
.grid-item:focus { outline:none; }
.grid-item:focus-visible { outline: none; }

/* ---------------- ENTRANCE ANIMATION (snappier) ---------------- */
.grid-item:not(.inactive) {
    animation: gridFadeIn var(--grid-entrance-duration) cubic-bezier(0.4,0,0.2,1) forwards;
    animation-delay: calc(var(--i,0) * var(--grid-entrance-stagger));
}
@keyframes gridFadeIn {
    0%   { opacity:0; transform: scale(0.96); filter: blur(4px); }
    60%  { opacity:0.12; transform: scale(1.01); filter: blur(1px); }
    100% { opacity:0; transform: scale(1); filter: blur(0); }
}

/* ---------------- Hero intro box styling ---------------- */
.hero-intro {
    display: flex;
    flex-direction: column;
    align-items: flex-start;     /* snap to left */
    justify-content: flex-start; /* snap to top */
    padding-left: clamp(1rem, 3vw, 4rem);
    padding-top: clamp(1rem, 4vh, 3rem);
    padding-right: clamp(1rem, 2vw, 2rem);
    padding-bottom: 1rem;
    text-align: left;
    pointer-events: auto;        /* allow text interaction */
}

/* Big serif heading */
.hero-intro-title {
    font-family: "Playfair Display", Georgia, "Times New Roman", serif;
    font-weight: 400;
    margin: 0;
    color: #fff;
    line-height: 0.9;
    letter-spacing: -0.5px;
    text-shadow: 0 6px 18px rgba(3,6,10,0.55);
    font-size: clamp(18px, 9.5vw, 40px);
    display: inline-block;
    white-space: nowrap;
    overflow: hidden;
}

/* thin underline bar */
.hero-intro-underline {
    width: min(48ch, 48%);
    height: 10px;
    background: rgba(220,210,190,0.7);
    margin: 0.6rem 0 1.2rem 0;
    border-radius: 4px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.35);
}

/* subtitle styling */
.hero-intro-subtitle {
    margin-top: 1rem;     /* small top margin */
    margin-bottom: 0;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    font-size: clamp(0.9rem, 1.05vw, 1.05rem);
    color: rgba(255,255,255,0.95);
    max-width: 55ch;
    line-height: 1.6;
    opacity: 0.95;
    text-align: left;
    transition: color 0.18s ease;
}

/* responsive tweaks */
@media (max-width: 640px) {
    .hero-intro {
        padding: 1rem;
    }
    .hero-intro-title {
        white-space: normal;
        font-size: clamp(32px, 12vw, 56px);
    }
    .hero-intro-underline {
        height: 6px;
        margin-top: 0.4rem;
        width: 60%;
    }
}

/* ---------------- Hero-intro: flat but hover-reveal + typing ---------------- */

/* Baseline: hero-intro inherits the invisible-by-default behavior like other grid items */
/* ---------------- Hero-intro: flat default, blurred on hover ---------------- */
/* ---------------- Hero-intro: animated blur + neutral tint (no blue) ---------------- */

/* baseline: invisible like other tiles, flat appearance */
/* ---------------- Hero-intro: consistent glassy blur, no tint mismatch ---------------- */
/* ---------------- Hero-intro: working blur, same tone as other tiles ---------------- */

.grid-item.hero-intro {
    position: relative;
    border: none !important;
    box-shadow: none !important;
    cursor: default;
    pointer-events: auto;

    /* invisible by default */
    opacity: 0;
    background: rgba(255, 255, 255, 0.05); /* must have a visible layer for blur */
    backdrop-filter: blur(0px);
    -webkit-backdrop-filter: blur(0px);

    transition:
            opacity 0.25s ease-out,
            backdrop-filter 0.4s ease,
            -webkit-backdrop-filter 0.4s ease,
            background-color 0.4s ease;
    will-change: opacity, backdrop-filter, background-color;
}

/* Hover/focus: reveal + animate blur in */
.grid-item.hero-intro:hover,
.grid-item.hero-intro:focus,
.grid-item.hero-intro:focus-within {
    opacity: 1 !important;
    background: rgba(255, 255, 255, 0.06); /* consistent tint */
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    transform: none !important;
    box-shadow: none !important;
    border: none !important;
    color: rgba(255, 255, 255, 0.96);
}

/* fade text in/out with hover */
.grid-item.hero-intro .hero-intro-title,
.grid-item.hero-intro .hero-intro-subtitle {
    color: rgba(255, 255, 255, 0);
    transition: color 0.25s ease;
}

.grid-item.hero-intro:hover .hero-intro-title,
.grid-item.hero-intro:hover .hero-intro-subtitle,
.grid-item.hero-intro:focus-within .hero-intro-title,
.grid-item.hero-intro:focus-within .hero-intro-subtitle {
    color: rgba(255, 255, 255, 0.96);
}

/* Keep visible while hovered even if grid dims others */
.home-grid:hover .grid-item.hero-intro:hover {
    opacity: 1 !important;
}

/* Accessibility focus outline */
.grid-item.hero-intro:focus-visible {
    outline: 2px solid rgba(255, 255, 255, 0.08);
    border-radius: 8px;
}

/* Mobile: if your mobile rules make items visible by default, keep tint logic consistent */
@media (max-width: 640px) {
    .grid-item.hero-intro {
        opacity: 1;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        background: rgba(255, 255, 255, 0.05);
    }
    .grid-item.hero-intro .hero-intro-title,
    .grid-item.hero-intro .hero-intro-subtitle {
        color: rgba(255, 255, 255, 0.95);
    }
    .hero-intro-title { white-space: normal; font-size: clamp(10px, 6vw, 25px); }
    .hero-intro { padding-left: 1rem; padding-right: 1rem; }
    .hero-intro-underline { height: 6px; margin-top: 0.4rem; width: 60%; }
}

/* reduced motion: skip typing animations */
@media (prefers-reduced-motion: reduce) {
    .hero-intro-title,
    .hero-intro-subtitle {
        transition: none !important;
    }
    .hero-intro-subtitle.typing::after { display: none; animation: none; }
}


/* Mobile: keep hero-intro visible by default (if your mobile rules show items always) */
/* If you want hero-intro to be visible on mobile like other text modules, leave as-is.
   Otherwise, the existing mobile media query will make .grid-item opacity:1 — no change needed. */


/*!* caret effect: add to the typing target elements *!*/
/*.hero-typing-target::after {*/
/*    content: "";*/
/*    display: inline-block;*/
/*    width: 0.5ch;*/
/*    height: 1em;*/
/*    margin-left: 0.15ch;*/
/*    background: rgba(255,255,255,0.95);*/
/*    vertical-align: middle;*/
/*    animation: blink 1s steps(2,start) infinite;*/
/*    opacity: 1;*/
/*}*/
/*@keyframes blink {*/
/*    0% { opacity: 1; }*/
/*    50% { opacity: 0; }*/
/*    100% { opacity: 1; }*/
/*}*/

/*!* Respect reduced-motion: remove blinking *!*/
/*@media (prefers-reduced-motion: reduce) {*/
/*    .hero-typing-target::after { display: none; animation: none; }*/
/*}*/


/* ---------------- RESPONSIVE BREAKPOINTS ---------------- */
@media (max-width:1100px) {
    :root { --grid-padding: clamp(0.5rem,2vw,1.2rem); }
    .home-grid { grid-template-columns: repeat(2,1fr); grid-template-rows: repeat(3,1fr); }
    .grid-item { max-height: 45vh; }
}

/* MOBILE: 1x9 vertical scroll; items visible by default; touch-friendly */
@media (max-width:640px) {
    :root { --hero-top-offset: var(--hero-top-offset-mobile); --grid-gap:0.6rem; --grid-padding:0.9rem; }

    .hero-grid-wrap {
        top: var(--hero-top-offset);
        height: calc(100vh - var(--hero-top-offset));
        max-height: calc(100vh - var(--hero-top-offset));
        overflow-y: auto; -webkit-overflow-scrolling: touch;
        align-items:flex-start; justify-content:flex-start; padding-bottom: env(safe-area-inset-bottom,16px);
    }

    .home-grid {
        display:grid; grid-template-columns: 1fr; grid-template-rows: none; height:auto; max-height:none;
        gap: var(--grid-gap); padding: var(--grid-padding); overflow:visible;
    }

    .grid-item {
        opacity:1; background: var(--grid-item-bg); color: rgba(255,255,255,0.95);
        transform:none; min-height: var(--mobile-item-min-height); max-height:70vh; height:auto;
        animation:none;
        box-shadow: 0 6px 18px rgba(0,0,0,0.28);
    }

    .thumb-module img { height:auto; object-fit:cover; opacity:1; }
    .grid-btn { color:#fff; background: rgba(255,255,255,0.10); }

    .grid-item:hover { transform:none; box-shadow: 0 8px 20px rgba(0,0,0,0.34); }
    .grid-item:active { transform: scale(0.998); }
}

/* large screens comfort */
@media (min-width:1600px) {
    :root { --grid-padding: clamp(1rem,2.2vw,3rem); --grid-gap: clamp(1rem,1.6vw,2rem); }
    .grid-item { min-height:160px; max-height:33vh; }
}

/* ---------------- ASPECT / GUARDRAILS ---------------- */
@supports (aspect-ratio:1/1) {
    .grid-item { aspect-ratio: 4/3; }
    @media (max-width:1100px) { .grid-item { aspect-ratio: 3/4; } }
    @media (max-width:640px) { .grid-item { aspect-ratio: auto; } }
    @media (min-width:1600px) { .grid-item { aspect-ratio: 16/9; } }
}

/* ---------------- HEADER SAFETY ---------------- */
.home-header { position:absolute; top:0; left:0; width:100%; z-index:50; pointer-events:none; }


/* ---------------- Hero-intro: robust blur + animated reveal ---------------- */

/* Ensure wrapper allows proper compositing */
.hero-grid-wrap {
    /* create its own stacking context so backdrop-filter can sample background correctly */
    isolation: isolate;
    -webkit-transform: translateZ(0); /* encourage GPU compositing */
    transform: translateZ(0);
}

/* Primary hero-intro styles; we use a visible translucent background layer (required) */
.grid-item.hero-intro {
    position: relative;
    z-index: 25; /* above grid cells but below header */
    pointer-events: auto;
    cursor: default;

    /* start invisible (like other tiles) but must have a semi-transparent background */
    opacity: 0;
    background: rgba(255,255,255,0.04);  /* subtle translucent layer required for backdrop-filter */
    -webkit-backdrop-filter: blur(0px);
    backdrop-filter: blur(0px);

    /* smooth animation */
    transition:
            opacity 0.22s cubic-bezier(0.4,0,0.2,1),
            backdrop-filter 0.42s cubic-bezier(0.4,0,0.2,1),
            -webkit-backdrop-filter 0.42s cubic-bezier(0.4,0,0.2,1),
            background-color 0.28s cubic-bezier(0.4,0,0.2,1);
    will-change: opacity, backdrop-filter, background-color;
    backface-visibility: hidden; /* helps some browsers */
}

/* Hover/focus: animate blur in and brighten slightly */
.grid-item.hero-intro:hover,
.grid-item.hero-intro:focus,
.grid-item.hero-intro:focus-within {
    opacity: 1 !important;
    background: rgba(255,255,255,0.06);   /* same tone as other tiles */
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
    transform: none !important;
    box-shadow: none !important;
}

/* text reveal rules unchanged */
.grid-item.hero-intro .hero-intro-title,
.grid-item.hero-intro .hero-intro-subtitle {
    color: rgba(255,255,255,0);
    transition: color 0.22s cubic-bezier(0.4,0,0.2,1);
    position: relative;
    z-index: 2;
}
.grid-item.hero-intro:hover .hero-intro-title,
.grid-item.hero-intro:hover .hero-intro-subtitle,
.grid-item.hero-intro:focus-within .hero-intro-title,
.grid-item.hero-intro:focus-within .hero-intro-subtitle {
    color: rgba(255,255,255,0.96);
}

/* if browser does not support backdrop-filter, .no-backdrop class will be added to body by JS;
   use slightly stronger translucent background as fallback (no blur) */
body.no-backdrop .grid-item.hero-intro {
    background: rgba(255,255,255,0.08) !important; /* slightly stronger tint for readability */
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
}

/* also make sure the hero background is visible behind the grid (no opaque overlay on .hero) */
.hero {
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
}

/* Mobile: show hero-intro like others if grid is mobile-visible */
@media (max-width: 640px) {
    .grid-item.hero-intro {
        opacity: 1;
        background: rgba(255,255,255,0.05);
        -webkit-backdrop-filter: blur(8px);
        backdrop-filter: blur(8px);
    }
    .grid-item.hero-intro .hero-intro-title,
    .grid-item.hero-intro .hero-intro-subtitle { color: rgba(255,255,255,0.95); }
}

{{ define "main" }}
<main class="hg-wrap" aria-label="Playground">

    {{/* Collect images under assets/images/** and emit pairs {thumb, full} */}}
    {{ $assets := resources.Match "images/**" }}
    {{ $pairs := slice }}

    {{ range $res := $assets }}
    {{ if eq $res.MediaType.MainType "image" }}

    {{/* Exclude png + svg explicitly */}}
    {{ if and (ne $res.MediaType.SubType "png") (ne $res.MediaType.SubType "svg") }}

    {{/* Only accept jpeg / jpg / webp */}}
    {{ if or (eq $res.MediaType.SubType "jpeg") (eq $res.MediaType.SubType "jpg") (eq $res.MediaType.SubType "webp") }}

    {{/* Create a small thumbnail (prefer webp) */}}
    {{ $thumb := "" }}
    {{ with $res.Resize "300x webp" }}
    {{ $thumb = .Permalink }}
    {{ else }}
    {{ with $res.Resize "300x jpg" }}
    {{ $thumb = .Permalink }}
    {{ else }}
    {{ $thumb = $res.Permalink }}
    {{ end }}
    {{ end }}

    {{/* Full original image permalink (use Permalink so it's reachable) */}}
    {{ $full := $res.Permalink }}

    {{/* Append the object pair */}}
    {{ $pairs = $pairs | append (dict "thumb" $thumb "full" $full) }}

    {{ end }}
    {{ end }}

    {{ end }}
    {{ end }}

    <script>
        // HG_IMAGES: array of objects { thumb: "<small-url>", full: "<original-url>" }
        window.HG_IMAGES = {{ $pairs | jsonify }};
    </script>

    <div id="hg-canvas" class="hg-canvas" tabindex="0"></div>

    <link rel="stylesheet" href="{{ "css/playground.css" | relURL }}">
    <script src="{{ "js/playground.js" | relURL }}" defer></script>

</main>
{{ end }}
